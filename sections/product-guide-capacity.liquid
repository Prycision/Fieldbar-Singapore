{% schema %}
{
  "name": "Capacity Lifestyle",
  "tag": "section",
  "class": "capacity-lifestyle-section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Fits more than you think"
    },
    {
      "type": "text",
      "id": "capacity_text",
      "label": "Capacity Text",
      "default": "Capacity | 24L"
    },
    {
      "type": "text",
      "id": "link_text",
      "label": "Link Text",
      "default": "Read More"
    },
    {
      "type": "url",
      "id": "link_url",
      "label": "Link URL"
    },
    {
      "type": "url",
      "id": "video_url",
      "label": "Right Column Background Video URL"
    }
  ],
  "blocks": [
    {
      "type": "item",
      "name": "Capacity Item",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Item Label",
          "default": "10 Wine Bottles 750ml"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Item Image"
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [
    {
      "name": "Capacity Lifestyle with Video"
    }
  ]
}
{% endschema %}

<style>
.capacity-lifestyle-section {
  display: flex;
  width: 100vw;
  height: 90vh;
  gap: 1em;
  box-sizing: border-box;
  color: #002B4D;
  font-family: "Gotham Narrow Book", sans-serif;
}

/* LEFT COLUMN */
.capacity-lifestyle__left {
  position: relative; /* for absolutely positioned link */
  width: 50%;
  background-color: #fffbf6;
  padding: 2em;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
}

.capacity-lifestyle__left h2 {
  font-family: "SurveyorText Book Light Pro", serif;
  font-size: 2em;
  text-transform: capitalize;
  margin-bottom: 1em;
}

.custom-list {
  list-style: decimal-leading-zero;
  padding-left: 4%;
  margin: 0 0 1em 0;
  flex-shrink: 0;
}

.list-item {
  cursor: pointer;
  transition: color 0.3s ease;
  margin-bottom: 0.5em;
  color: #002B4D;
}

.list-item.active {
  font-style: italic;
  color: #01324c;
}

.capacity-lifestyle__capacity {
  text-align: right;
  margin: 1em 0;
  flex-shrink: 0;
}

.capacity-lifestyle__capacity p {
  margin: 0;
}

.image-display {
  width: 100%;
  flex-grow: 1; 
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 1em;
}

.image-display img {
  max-width: 50vw;
  height: 30vh;
  object-fit: contain;
}


.cap-text {
  position: absolute;
  bottom: 1em;
  right: 1em;
  display: inline-block;
  align-self: flex-end !important ;
  color: #002d53;
  text-decoration: none;
  font-weight: 600;
  font-family: "Gotham Narrow Book", sans-serif !important;
  transition: color 0.3s ease;
}
.cap-text::after {
  content: "";
  position: absolute;
  left: 0;
  bottom: -2px;
  width: 100%;
  height: 2px;
  background-color: #FF8A3D;
  transform: scaleX(1);
  transform-origin: right;
  transition: transform 0.5s ease;
}
.cap-text:hover {
  color: #FF8A3D;
}
.cap-text:hover::after {
  transform: scaleX(0);
}

/* RIGHT COLUMN VIDEO */
.capacity-lifestyle__right-video {
  width: 50%;
  position: relative;
  overflow: hidden;
}

.capacity-lifestyle__video-wrapper {
  width: 100%;
  height: 100%;
  min-height: 60vh;
}

.capacity-lifestyle__video-wrapper video {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center center;
  display: block;
}

@media screen and (max-width: 768px) {
  .capacity-lifestyle-section {
    flex-direction: column;
    height: auto;
  }
  .capacity-lifestyle__left,
  .capacity-lifestyle__right-video {
    width: 100%;
  }

  
  .image-display img {
    width: 80vw;
    height: auto;
    max-height: 40vh;
  }
  /* Move the link below content */
  .cap-text {
    position: static;
    margin: 1em 0 0;
  }
}
</style>

<div class="capacity-lifestyle-section">
  <!-- Left column -->
  <div class="capacity-lifestyle__left">
    <h2>{{ section.settings.heading }}</h2>

    <ul class="custom-list">
      {% for block in section.blocks %}
        {% if block.settings.image %}
          <li class="list-item {% if forloop.first %}active{% endif %}"
              data-image="{{ block.settings.image | image_url }}">
            {{ block.settings.label }}
          </li>
        {% endif %}
      {% endfor %}
    </ul>

    <div class="capacity-lifestyle__capacity">
      <p>{{ section.settings.capacity_text }}</p>
    </div>

    <div class="image-display">
      {% assign first = section.blocks.first %}
      {% if first and first.settings.image %}
        <img id="displayedImage"
             src="{{ first.settings.image | image_url }}"
             alt="{{ first.settings.label }}">
      {% endif %}
    </div>

    {% if section.settings.link_url %}
      <a href="{{ section.settings.link_url }}" class="cap-text">
        {{ section.settings.link_text }}
      </a>
    {% endif %}
  </div>

  <!-- Right column: video -->
  <div class="capacity-lifestyle__right-video">
    <div class="capacity-lifestyle__video-wrapper">
      {% if section.settings.video_url %}
        <video autoplay muted loop playsinline>
          <source src="{{ section.settings.video_url }}" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      {% endif %}
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const section = document.querySelector('.capacity-lifestyle-section');
  if (!section) return;

  const items = section.querySelectorAll('.list-item');
  const displayedImage = section.querySelector('#displayedImage');

  items.forEach(item => {
    item.addEventListener('mouseenter', () => {
      items.forEach(i => i.classList.remove('active'));
      item.classList.add('active');
      const src = item.dataset.image;
      if (displayedImage && src) {
        displayedImage.src = src;
      }
    });
  });
});
</script>
